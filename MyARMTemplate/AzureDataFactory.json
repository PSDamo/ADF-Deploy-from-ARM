{"contentVersion":"1.0.0.0","$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","parameters":{"DataFactoryName":{"type":"string","defaultValue":"MyADFProject","minLength":3,"maxLength":30}},"resources":[{"name":"[parameters('DataFactoryName')]","apiVersion":"2015-10-01","type":"Microsoft.DataFactory/datafactories","location":"[resourceGroup().location]","resources":[{"name":"AzureBatchLinkedService","properties":{"type":"AzureBatch","typeProperties":{"accountName":"<nameoftheaccountNOTwholeURL>","accessKey":"<Bach access key>","poolName":"<name of the Batch pool>","batchUri":"<URL without accountName. Ex: https://<region>.batch.azure.com>","linkedServiceName":"AzureStorageLinkedService"}},"type":"linkedservices","apiVersion":"2015-10-01","dependsOn":["[parameters('DataFactoryName')]"]},{"name":"AzureStorageLinkedService","properties":{"type":"AzureStorage","typeProperties":{"connectionString":"DefaultEndpointsProtocol=https;AccountName=<accountname>;AccountKey=<accountkey>"}},"type":"linkedservices","apiVersion":"2015-10-01","dependsOn":["[parameters('DataFactoryName')]"]},{"name":"OutputTable","properties":{"type":"AzureBlob","linkedServiceName":"AzureStorageLinkedService","typeProperties":{"folderPath":"<blob container>/httpDownloadDataIn/{Slice}/","partitionedBy":[{"name":"Slice","value":{"type":"DateTime","date":"SliceStart","format":"yyyyMMddHHmm"}}]},"availability":{"frequency":"Hour","interval":"1"}},"type":"datasets","apiVersion":"2015-10-01","dependsOn":["[parameters('DataFactoryName')]","AzureStorageLinkedService"]},{"name":"DataDownloaderSamplePipeline","properties":{"description":"Custom Data Downloader from an HTTP EndPoint Sample Pipeline","activities":[{"name":"DownloadData","description":"Download raw data from an http endpoint","linkedServiceName":"AzureBatchLinkedService","type":"DotNetActivity","typeProperties":{"assemblyName":"MyCustomActivity.dll","entryPoint":"DataDownloaderActivityNS.DataDownloaderActivity","packageLinkedService":"AzureStorageLinkedService","packageFile":"<blob container>/package/MyCustomActivity.zip","extendedProperties":{"sliceStart":"$$Text.Format('{0:yyyyMMddHHmm}', SliceStart)","urlFormat":"http://dumps.wikimedia.org/other/pagecounts-raw/{0}/{0}-{1}/pagecounts-{0}{1}{2}-{3}00{4}.gz","dataStorageAccountName":"<Azure storage account name>","dataStorageAccountKey":"<Azure storage account key>","dataStorageContainer":"<Blob container name in Azure storage>"}},"outputs":[{"name":"OutputTable"}],"policy":{"executionPriorityOrder":"OldestFirst","timeout":"00:30:00","concurrency":"2","retry":"2"},"scheduler":{"frequency":"Hour","interval":"1"}}],"start":"2015-03-08 00:00:00","end":"2015-03-09 00:00:00","isPaused":"False"},"type":"datapipelines","apiVersion":"2015-10-01","dependsOn":["[parameters('DataFactoryName')]"]}]}]}